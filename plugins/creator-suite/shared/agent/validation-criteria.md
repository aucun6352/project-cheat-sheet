# Sub-Agent Validation Criteria

This document defines the criteria for evaluating the quality of sub-agent files generated by the `/create-agent` command.

## Evaluation System

**Total Score: 100 points**

| Score Range | Grade | Assessment |
|-------------|-------|------------|
| 90-100 | A | Excellent |
| 80-89 | B | Good |
| 70-79 | C | Fair |
| 60-69 | D | Poor |
| 0-59 | F | Fail |

---

## 1. Structure Validation (20 points)

### 1.1 File Location (10 points)
- ‚úÖ **10 points**: Located in `.claude/agents/` directory
- ‚ö†Ô∏è **5 points**: Different location but agents directory exists
- ‚ùå **0 points**: Incorrect location

### 1.2 Filename Convention (10 points)
- ‚úÖ **10 points**: kebab-case format (e.g., `code-reviewer.md`)
- ‚ö†Ô∏è **5 points**: Lowercase but no hyphens
- ‚ùå **0 points**: Using camelCase, PascalCase, or snake_case

**Validation Method**:
```bash
# Correct examples
.claude/agents/code-reviewer.md
.claude/agents/test-coordinator.md

# Incorrect examples
.claude/agents/CodeReviewer.md     # PascalCase
.claude/agents/code_reviewer.md    # snake_case
agents/code-reviewer.md             # Wrong location
```

---

## 2. Frontmatter Validation (20 points)

### 2.1 name Field (5 points)
- ‚úÖ **5 points**: Required field exists, kebab-case format
- ‚ö†Ô∏è **3 points**: Exists but format error
- ‚ùå **0 points**: Field missing

### 2.2 description Field (5 points)
- ‚úÖ **5 points**: Clear description of 10-500 characters
- ‚ö†Ô∏è **3 points**: Too short or too long (less than 10 or more than 500 characters)
- ‚ùå **0 points**: Field missing

### 2.3 tools Field (5 points)
- ‚úÖ **5 points**: Correct format (comma-separated, valid tool names)
- ‚ö†Ô∏è **3 points**: Correct format but includes unnecessary tools
- ‚úÖ **5 points**: Omitted (allows all tools)
- ‚ùå **0 points**: Incorrect format or non-existent tools

**Valid Tools**: Read, Write, Edit, Bash, Grep, Glob, WebFetch, WebSearch, etc.

### 2.4 model Field (5 points)
- ‚úÖ **5 points**: One of inherit, sonnet, opus, haiku
- ‚ö†Ô∏è **3 points**: Omitted (default inherit used)
- ‚ùå **0 points**: Invalid model name

**Correct Frontmatter Example**:
```yaml
---
name: code-reviewer
description: "Professional reviewer that systematically verifies TypeScript and Python code quality, security, and performance"
tools: Read,Grep,Bash
model: sonnet
---
```

---

## 3. System Prompt Quality (30 points)

### 3.1 Role Definition Clarity (8 points)
- ‚úÖ **8 points**: Agent's role and responsibilities clearly defined
- ‚ö†Ô∏è **4 points**: Role exists but vague
- ‚ùå **0 points**: No role definition

**Evaluation Criteria**:
- Is what the agent does clear?
- Is the area of expertise specifically stated?
- Can users understand when to use this agent?

### 3.2 Trigger Condition Specificity (7 points)
- ‚úÖ **7 points**: 3 or more specific trigger conditions
- ‚ö†Ô∏è **4 points**: Triggers exist but vague (1-2)
- ‚ùå **0 points**: No trigger conditions

**Good Example**:
```markdown
## Triggers
- User mentions "lint", "eslint", or "format code"
- .ts or .js files are modified
- Explicit request: "run eslint"
```

### 3.3 Behavioral Guidelines Detail (8 points)
- ‚úÖ **8 points**: Clear step-by-step behavioral guidelines (3+ steps)
- ‚ö†Ô∏è **4 points**: Guidelines exist but abstract
- ‚ùå **0 points**: No behavioral guidelines

**Evaluation Elements**:
- Is the work process explained step by step?
- Is what needs to be done at each step clear?
- Is error handling mentioned?

### 3.4 Output Format Specification (7 points)
- ‚úÖ **7 points**: Output format clearly defined with examples
- ‚ö†Ô∏è **4 points**: Output format exists but no examples
- ‚ùå **0 points**: No output format mentioned

**Good Example**:
````markdown
## Output Format
```
‚úÖ ESLint Results for {file}

Fixed Issues:
- [Line 23] semi: Missing semicolon
- [Line 45] no-unused-vars: 'data' is defined but never used

Remaining Issues:
- [Line 67] complexity: Function too complex (12 > 10)
```
````

---

## 4. Tool Configuration Appropriateness (15 points)

### 4.1 Principle of Least Privilege (8 points)
- ‚úÖ **8 points**: Only minimum tools required for role
- ‚ö†Ô∏è **4 points**: Some unnecessary tools included
- ‚ùå **0 points**: All tools indiscriminately allowed

**Evaluation Criteria**:
- Read-only task but has Write permission? (deduction)
- File search not needed but has Grep, Glob? (deduction)
- Bash execution not needed but has Bash permission? (deduction)

### 4.2 Security Considerations (7 points)
- ‚úÖ **7 points**: Security risks specified and boundary conditions clear
- ‚ö†Ô∏è **4 points**: Boundary conditions exist but insufficient security considerations
- ‚ùå **0 points**: No security considerations

**Verification Items**:
```markdown
## Boundaries
**Will Not:**
- Execute potentially dangerous code
- Modify production database directly
- Access external APIs without permission
```

---

## 5. Expertise Level Alignment (10 points)

### 5.1 Type and Complexity Match (5 points)
- ‚úÖ **5 points**: Selected type matches actual complexity
- ‚ö†Ô∏è **3 points**: Slight mismatch
- ‚ùå **0 points**: Clear mismatch

| Type | Expected Complexity | Word Count Range |
|------|---------------------|------------------|
| Specialist | Low | 100-300 |
| Analyst | Medium | 300-800 |
| Orchestrator | High | 800-2000+ |

### 5.2 Word Count Appropriateness (5 points)
- ‚úÖ **5 points**: Within recommended range for type
- ‚ö†Ô∏è **3 points**: Deviates ¬±20% from range
- ‚ùå **0 points**: Significantly outside range

**Validation Method**:
```bash
# Calculate word count in markdown body (excluding Frontmatter)
wc -w .claude/agents/code-reviewer.md
```

---

## 6. Consistency and Completeness (5 points)

### 6.1 Grammar and Typos (3 points)
- ‚úÖ **3 points**: No typos, accurate grammar
- ‚ö†Ô∏è **2 points**: Minor typos 1-2
- ‚ùå **0 points**: Multiple typos or grammar errors

### 6.2 Completeness (2 points)
- ‚úÖ **2 points**: All sections complete, no TODOs
- ‚ö†Ô∏è **1 point**: Some sections incomplete or TODOs exist
- ‚ùå **0 points**: Mostly incomplete

---

## Validation Checklist

Verify that the generated sub-agent file satisfies all of the following:

### Required Elements (Must Include)
- [ ] Frontmatter (separated by `---`)
- [ ] `name` field (kebab-case)
- [ ] `description` field (10-500 characters)
- [ ] Agent role definition
- [ ] Trigger conditions (minimum 1)
- [ ] Behavioral guidelines or workflow
- [ ] Boundary conditions (Will/Will Not)

### Recommended Elements (Bonus Points if Included)
- [ ] `tools` field (explicit permission control)
- [ ] `model` field (performance optimization)
- [ ] Output format examples
- [ ] Error handling methods
- [ ] Usage examples
- [ ] Security considerations

### Quality Indicators
- [ ] Word count appropriate for type
- [ ] Role and tools match
- [ ] No typos or grammar errors
- [ ] No TODOs or incomplete sections

---

## Automated Validation Script (Reference)

```bash
#!/bin/bash
# validate-agent.sh - Sub-agent file validation

AGENT_FILE="$1"

if [ ! -f "$AGENT_FILE" ]; then
  echo "‚ùå File not found: $AGENT_FILE"
  exit 1
fi

score=0

# 1. File location validation
if [[ "$AGENT_FILE" == *".claude/agents/"* ]]; then
  echo "‚úÖ Correct file location (+10 points)"
  score=$((score + 10))
else
  echo "‚ùå Incorrect file location (0 points)"
fi

# 2. Filename validation (kebab-case)
filename=$(basename "$AGENT_FILE" .md)
if [[ "$filename" =~ ^[a-z]+(-[a-z]+)*$ ]]; then
  echo "‚úÖ Correct filename format (+10 points)"
  score=$((score + 10))
else
  echo "‚ùå Filename format error: $filename (0 points)"
fi

# 3. Frontmatter validation
if grep -q "^---$" "$AGENT_FILE"; then
  echo "‚úÖ Frontmatter exists (+5 points)"
  score=$((score + 5))

  # name field
  if grep -q "^name:" "$AGENT_FILE"; then
    echo "‚úÖ name field exists (+5 points)"
    score=$((score + 5))
  fi

  # description field
  if grep -q "^description:" "$AGENT_FILE"; then
    echo "‚úÖ description field exists (+5 points)"
    score=$((score + 5))
  fi
else
  echo "‚ùå No frontmatter (0 points)"
fi

# Final score
echo ""
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo "üìä Validation Score: $score/100"

if [ $score -ge 90 ]; then
  echo "üèÜ Grade: A (Excellent)"
elif [ $score -ge 80 ]; then
  echo "ü•à Grade: B (Good)"
elif [ $score -ge 70 ]; then
  echo "ü•â Grade: C (Fair)"
elif [ $score -ge 60 ]; then
  echo "‚ö†Ô∏è Grade: D (Poor)"
else
  echo "‚ùå Grade: F (Fail)"
fi
```

---

## Evaluation Examples

### Example 1: Excellent Agent (Grade A, 95 points)

```markdown
---
name: code-reviewer
description: "Professional reviewer that systematically verifies TypeScript and Python code quality, security, and performance"
tools: Read,Grep,Bash
model: sonnet
---

# Code Reviewer

You are an expert code reviewer specializing in TypeScript and Python.

## Role
Perform thorough code reviews focusing on quality, security, performance, and maintainability.

## Triggers
- PR creation or update
- User requests "review this code"
- Files with `.ts`, `.tsx`, `.py` extensions modified

## Review Process
1. **Read** the code files
2. **Analyze** for issues (security, performance, maintainability, style)
3. **Grep** for common anti-patterns
4. **Report** findings with severity levels

## Output Format
```
üìã Code Review Report
...
```

## Boundaries
**Will:**
- Analyze code thoroughly
- Provide specific, actionable feedback

**Will Not:**
- Modify code directly (analysis only)
- Execute potentially dangerous code
```

**Evaluation**:
- Structure: 20/20 ‚úÖ
- Frontmatter: 20/20 ‚úÖ
- System Prompt: 28/30 ‚úÖ
- Tool Configuration: 15/15 ‚úÖ
- Expertise Level: 10/10 ‚úÖ
- Completeness: 2/5 ‚ö†Ô∏è (Output example incomplete)
- **Total: 95/100 (A)**

### Example 2: Needs Improvement (Grade C, 72 points)

```markdown
---
name: myAgent
description: "Code review"
---

# My Agent

This agent reviews code.

## Tasks
Reads code and finds problems.
```

**Evaluation**:
- Structure: 10/20 ‚ö†Ô∏è (Filename error: camelCase)
- Frontmatter: 8/20 ‚ùå (name format error, description too short)
- System Prompt: 12/30 ‚ùå (Vague role, no triggers, no output format)
- Tool Configuration: 15/15 ‚úÖ (Omitted = all tools)
- Expertise Level: 5/10 ‚ö†Ô∏è (Insufficient word count)
- Completeness: 2/5 ‚ö†Ô∏è
- **Total: 52/100 (F)**

**Improvement Needed**:
1. Change filename to `my-agent.md`
2. Specify description (10+ characters)
3. Add trigger conditions
4. Detail behavioral guidelines
5. Define output format
6. Add boundary conditions

---

## Conclusion

Use these validation criteria to:
- ‚úÖ Objectively evaluate generated sub-agent quality
- ‚úÖ Clearly identify areas needing improvement
- ‚úÖ Maintain consistent agent quality
- ‚úÖ Improve overall team agent quality
