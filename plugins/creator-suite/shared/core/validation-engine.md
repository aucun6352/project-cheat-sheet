# Validation Engine - 100점 만점 품질 검증 시스템

Phase 4에서 사용되는 자동 품질 검증 엔진입니다. 생성된 문서의 품질을 100점 만점으로 평가하고 A/B/C/D/F 등급을 부여합니다.

## 목적

생성된 문서가 다음 기준을 충족하는지 자동으로 검증:
- 구조적 완성도
- 필수 항목 포함 여부
- 내용의 명확성과 실용성
- 타입별 특화 요구사항 충족

## 검증 체계

### 100점 만점 구성

모든 생성 대상은 다음 6가지 영역에서 평가됩니다:

| 영역 | 배점 | 설명 |
|------|------|------|
| **구조 검증** | 20점 | 파일 구조, 섹션 계층, 포맷팅 |
| **Frontmatter 검증** | 15-20점 | 메타데이터 완성도 및 정확성 |
| **필수 섹션 검증** | 20-25점 | 타입별 필수 섹션 포함 여부 |
| **콘텐츠 품질 검증** | 25점 | 내용의 명확성, 구체성, 실용성 |
| **타입 적합성** | 10점 | 선택된 타입에 맞는 구조/내용 |
| **완성도** | 5-10점 | 예제, 문서화, 완결성 |

---

## 1. 구조 검증 (20점)

### 파일 구조 (10점)

**검증 항목**:
```yaml
Frontmatter 존재: 5점
- YAML 형식 올바름: 5점
- YAML 파싱 실패: 0점

마크다운 구조: 5점
- 헤더 계층 올바름 (H1 → H2 → H3): 5점
- 헤더 계층 일부 오류: 3점
- 심각한 구조 오류: 0점
```

**예시**:
```markdown
✅ 올바른 구조 (10점):
---
name: example
---
# H1 Title
## H2 Section
### H3 Subsection

❌ 잘못된 구조 (3점):
---
name: example
# H1 Title
#### H4 (H2/H3 건너뜀)
```

### 섹션 계층 (10점)

**검증 규칙**:
```yaml
헤더 순서: 5점
- H1 단일 존재: 2점
- H2 이상 존재: 2점
- 계층 일관성: 1점

섹션 분리: 5점
- 논리적 섹션 구분: 3점
- 적절한 공백: 2점
```

---

## 2. Frontmatter 검증 (15-20점)

### 공통 필드 (10점)

**필수 필드**:
```yaml
name: 5점
- 존재 및 kebab-case: 5점
- 존재하나 형식 오류: 2점
- 없음: 0점

description: 5점
- 존재 및 적절한 길이 (20-150자): 5점
- 너무 짧거나 김: 3점
- 없음: 0점
```

### 타입별 추가 필드

#### Agent (추가 10점)
```yaml
tools: 5점 (선택)
- 올바른 배열 형식: 5점
- 형식 오류: 2점

model: 5점 (선택)
- 유효한 값 (inherit/sonnet/opus/haiku): 5점
- 잘못된 값: 0점
```

#### Command (추가 5점)
```yaml
기본 필드만으로 충분: 15점
추가 커스텀 필드 적절히 사용: +5점
```

#### Skill (추가 5점)
```yaml
기본 필드만으로 충분: 15점
tags, prerequisites 등 추가: +5점
```

---

## 3. 필수 섹션 검증 (20-25점)

타입별로 다른 필수 섹션을 요구합니다.

### Agent 필수 섹션 (25점)

```yaml
Instructions: 10점
- 명확한 행동 지침: 10점
- 모호한 설명: 5점
- 없음: 0점

Examples (선택): 5점
- 구체적 예제 1개 이상: 5점
- 없음: 3점 (감점 없음, 보너스)

Best Practices (선택): 5점
- 실용적 가이드: 5점
- 없음: 3점

Troubleshooting (선택): 5점
- 일반적 문제 해결: 5점
- 없음: 3점
```

### Command 필수 섹션 (25점)

```yaml
Triggers: 5점
- 명확한 실행 조건: 5점
- 모호함: 2점
- 없음: 0점

Behavioral Flow: 10점
- 단계별 실행 로직: 10점
- 불완전: 5점
- 없음: 0점

Boundaries: 5점
- Will/Will Not 명확: 5점
- 일부만: 2점
- 없음: 0점

Examples: 5점
- 실제 사용 예제: 5점
- 없음: 2점
```

### Skill 필수 섹션 (20점)

```yaml
Core Concept: 5점
- 핵심 개념 설명: 5점
- 불충분: 2점
- 없음: 0점

Practical Application: 10점
- 실제 적용 방법: 10점
- 추상적 설명만: 5점
- 없음: 0점

Examples: 5점
- 실습 예제: 5점
- 없음: 2점
```

---

## 4. 콘텐츠 품질 검증 (25점)

### 명확성 (10점)

**검증 기준**:
```yaml
설명 명확성: 5점
- 모호하지 않은 설명: 5점
- 일부 모호: 3점
- 대부분 모호: 0점

전문 용어 사용: 5점
- 적절한 용어 사용 및 설명: 5점
- 용어만 나열: 2점
```

### 구체성 (10점)

**검증 기준**:
```yaml
예제 품질: 5점
- 실제 사용 가능한 예제: 5점
- 추상적 예제: 3점
- 예제 없음: 0점

단계별 설명: 5점
- 상세한 단계 설명: 5점
- 간략한 설명: 3점
- 단계 없음: 0점
```

### 실용성 (5점)

**검증 기준**:
```yaml
실행 가능성: 5점
- 즉시 사용 가능: 5점
- 약간의 수정 필요: 3점
- 크게 불완전: 0점
```

---

## 5. 타입 적합성 (10점)

선택된 타입에 맞는 구조와 내용인지 검증합니다.

### Agent 타입 적합성

**Specialist** (단순 작업):
```yaml
복잡도 검증: 5점
- 단일 목적 명확: 5점
- 복잡도 높음: 2점

도구 개수: 5점
- 1-3개 도구: 5점
- 4개 이상: 3점
```

**Analyst** (중간 복잡도):
```yaml
분석 능력: 5점
- 분석 로직 명확: 5점
- 분석 부족: 2점

도구 사용: 5점
- 3-6개 도구: 5점
- 범위 벗어남: 3점
```

**Orchestrator** (복잡한 조율):
```yaml
조율 능력: 5점
- 다중 에이전트/도구 조율: 5점
- 단순 작업: 2점

워크플로우: 5점
- 복잡한 흐름 제어: 5점
- 단순 순차 실행: 3점
```

### Command 타입 적합성

**Simple Task** (50-150 단어):
```yaml
단순성: 5점
- 단일 작업 명확: 5점
- 복잡함: 2점

길이: 5점
- 50-150 단어: 5점
- 범위 벗어남: 3점
```

**Workflow Pipeline** (150-400 단어):
```yaml
순차성: 5점
- 명확한 순서: 5점
- 순서 불명확: 2점

길이: 5점
- 150-400 단어: 5점
- 범위 벗어남: 3점
```

**Complex Orchestration** (400+ 단어):
```yaml
복잡성: 5점
- 조건/반복/예외 처리: 5점
- 단순 흐름: 2점

길이: 5점
- 400+ 단어: 5점
- 너무 짧음: 2점
```

### Skill 타입 적합성

**Quick Workflow** (50-200 단어):
```yaml
간결성: 5점
- 핵심만 설명: 5점
- 장황함: 2점

길이: 5점
- 50-200 단어: 5점
- 범위 벗어남: 3점
```

**Comprehensive Guide** (200-600 단어):
```yaml
완성도: 5점
- 단계별 가이드: 5점
- 불완전: 2점

길이: 5점
- 200-600 단어: 5점
- 범위 벗어남: 3점
```

**Deep Dive** (600-1500 단어):
```yaml
심층성: 5점
- 깊이 있는 분석: 5점
- 피상적: 2점

길이: 5점
- 600-1500 단어: 5점
- 범위 벗어남: 3점
```

**Pattern Library** (1500+ 단어):
```yaml
포괄성: 5점
- 다양한 패턴: 5점
- 제한적: 2점

길이: 5점
- 1500+ 단어: 5점
- 너무 짧음: 2점
```

---

## 6. 완성도 (5-10점)

### 기본 완성도 (5점)

```yaml
시작과 끝: 2점
- 도입부와 결론 존재: 2점
- 일부 누락: 1점

일관성: 3점
- 전체 톤/스타일 일관: 3점
- 불일치: 1점
```

### 추가 완성도 (선택, +5점)

```yaml
Troubleshooting: 2점
- 문제 해결 섹션: 2점

Related Resources: 2점
- 관련 문서 링크: 2점

Version History: 1점
- 버전/변경 이력: 1점
```

---

## 등급 체계

### 점수 → 등급 변환

```yaml
A (90-100점):
  품질: 우수 (Excellent)
  메시지: "✅ 고품질 문서입니다. 즉시 사용 가능합니다."

B (80-89점):
  품질: 좋음 (Good)
  메시지: "👍 좋은 품질입니다. 약간의 개선이 도움될 수 있습니다."

C (70-79점):
  품질: 보통 (Fair)
  메시지: "⚠️ 사용 가능하지만 개선이 권장됩니다."

D (60-69점):
  품질: 미흡 (Poor)
  메시지: "❌ 품질이 미흡합니다. 수정을 권장합니다."

F (<60점):
  품질: 불합격 (Fail)
  메시지: "🚫 심각한 문제가 있습니다. 재작성이 필요합니다."
```

---

## 검증 결과 보고

### 상세 보고서 형식

```markdown
## 📊 품질 검증 결과

**종합 점수**: 85/100 (B)
**등급**: 좋음 (Good)

### 세부 점수

| 영역 | 점수 | 만점 | 비율 |
|------|------|------|------|
| 구조 검증 | 18 | 20 | 90% |
| Frontmatter 검증 | 15 | 20 | 75% |
| 필수 섹션 검증 | 22 | 25 | 88% |
| 콘텐츠 품질 검증 | 20 | 25 | 80% |
| 타입 적합성 | 8 | 10 | 80% |
| 완성도 | 7 | 10 | 70% |

### ✅ 강점
- 명확한 구조와 섹션 구성
- 실용적인 예제 포함
- 타입에 맞는 복잡도

### ⚠️ 개선 사항
- Frontmatter에 추가 필드 권장 (-5점)
- Troubleshooting 섹션 추가 권장 (-3점)

### 💡 권장 사항
1. `tools` 필드를 Frontmatter에 추가하여 명시적으로 도구 정의
2. 일반적인 문제 및 해결 방법을 Troubleshooting 섹션에 추가
3. Related Resources 섹션으로 관련 문서 링크

**최종 평가**: 👍 좋은 품질입니다. 즉시 사용 가능하며, 위 개선사항 반영 시 A 등급 달성 가능합니다.
```

---

## 실전 예제

### 예제 1: A 등급 Agent (95점)

**파일**: `api-test-specialist.md`

```markdown
---
name: api-test-specialist
description: "REST API 엔드포인트 테스트 자동화 전문 에이전트"
tools: ['Bash', 'Read', 'Write']
model: sonnet
---

# API Test Specialist

REST API 엔드포인트를 체계적으로 테스트하고 검증합니다.

## Instructions
[명확한 행동 지침 10줄]

## Examples
[구체적 예제 2개]

## Best Practices
[실용적 가이드 5개]

## Troubleshooting
[일반적 문제 3개]
```

**검증 결과**:
```
구조: 20/20
Frontmatter: 20/20 (모든 필드 완벽)
필수 섹션: 25/25 (모든 섹션 포함)
콘텐츠 품질: 20/25 (예제 더 구체적이면 만점)
타입 적합성: 10/10 (Specialist 타입 완벽)
완성도: 10/10 (모든 선택 섹션 포함)
---
총점: 95/100 (A)
```

### 예제 2: C 등급 Command (75점)

**파일**: `build-project.md`

```markdown
---
name: build-project
description: "프로젝트 빌드"
---

# Build Project

프로젝트를 빌드합니다.

## Triggers
프로젝트 빌드 필요 시

## Behavioral Flow
1. 빌드 실행
2. 결과 확인

## Boundaries
**Will**: 빌드 실행
**Will Not**: 배포
```

**검증 결과**:
```
구조: 15/20 (섹션 계층 부족)
Frontmatter: 10/15 (description 너무 간략)
필수 섹션: 15/25 (섹션은 있지만 내용 부족)
콘텐츠 품질: 15/25 (너무 추상적)
타입 적합성: 10/10 (Simple Task 적합)
완성도: 10/10 (기본 완성)
---
총점: 75/100 (C)

개선 필요:
- Description 구체화
- Behavioral Flow 상세화
- 예제 추가
```

---

## 검증 자동화

### 검증 실행 시점

1. **파일 생성 직후** (Phase 4):
   - 자동 검증 실행
   - 결과 즉시 보고

2. **평가 커맨드 실행 시**:
   - `/evaluate-agent {name}`
   - `/evaluate-command {name}`
   - `/evaluate-skill {name}`

### 검증 플래그

```bash
# 간단한 검증 (점수만)
--quick-validation

# 상세 검증 (기본)
--detailed-validation

# 개선 제안 포함
--with-suggestions
```

---

## 관련 문서

- `@phase-system.md`: Phase 4 파일 생성 프로세스
- `@../agent/validation-criteria.md`: Agent 특화 검증 기준
- `@../command/validation-criteria.md`: Command 특화 검증 기준
- `@../skill/validation-criteria.md`: Skill 특화 검증 기준
